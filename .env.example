# ============================================
# TikTok Daily Scraper v2.1 Configuration
# ============================================

# Apify Configuration
APIFY_TOKEN=apify_api_YOUR_TOKEN_HERE

# Primary Actor (cheap, runs first)
PRIMARY_ACTOR_ID=apidojo/tiktok-profile-scraper

# Fallback Actor (expensive, runs only if primary fails)
FALLBACK_ACTOR_ID=clockworks/tiktok-profile-scraper

# MongoDB Atlas
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/tiktok_scraper?retryWrites=true&w=majority

# ============================================
# Scraper Settings
# ============================================

# TikTok profile to scrape
PROFILE_HANDLE=success_israel

# Maximum posts to fetch (default: 40, reduced from 50 for cost optimization)
MAX_POSTS=40

# Timezone for date calculations
TIMEZONE=Asia/Jerusalem

# Low results threshold (triggers fallback if fewer results)
LOW_RESULTS_THRESHOLD=10

# Note: System automatically collects videos from yesterday (00:00-23:59)

# ============================================
# System Settings
# ============================================

NODE_ENV=production
LOG_LEVEL=info

# Backup retention in days
BACKUP_RETENTION_DAYS=14

# Actor run timeout in minutes
RUN_TIMEOUT_MINUTES=12

# Poll interval for checking actor status (seconds)
POLL_INTERVAL_SECONDS=10

# Maximum retries for network operations
MAX_RETRIES=3

# Lock TTL (Time To Live) in minutes
# Prevents concurrent runs from overlapping
# Recommended: 45 minutes (typical run takes 5-10 minutes)
LOCK_TTL_MINUTES=45

# ============================================
# Circuit Breaker (Cost Protection)
# ============================================

# Maximum fallback runs allowed within 48 hours
# If this limit is reached, fallback will be blocked to prevent excessive costs
# Recommended: 1 (allows one fallback every 48 hours)
FALLBACK_MAX_PER_48H=1

# ============================================
# Data Quality Checks (v2.1.0)
# ============================================

# Maximum allowed percentage of items with missing createTime (0.0 to 1.0)
# If exceeded, triggers DATA_QUALITY_ISSUE warning and may trigger fallback
# Recommended: 0.3 (30% tolerance)
MAX_MISSING_CREATETIME_PCT=0.3

# Maximum allowed percentage of items with missing URL (0.0 to 1.0)
# If exceeded, triggers DATA_QUALITY_ISSUE warning
# Recommended: 0.3 (30% tolerance)
MAX_MISSING_URL_PCT=0.3

# ============================================
# Email Configuration (v2.2.0)
# ============================================

# Email provider (currently only 'brevo' is supported)
# Leave commented to disable email sending
# EMAIL_PROVIDER=brevo

# Brevo API Key (get from: https://app.brevo.com/settings/keys/api)
# BREVO_API_KEY=xkeysib-YOUR_API_KEY_HERE

# From email (must be verified domain, e.g., vai.co.il)
# EMAIL_FROM=support@vai.co.il
# EMAIL_FROM_NAME=VAI Reports

# To email(s) - comma-separated for multiple recipients
# EMAIL_TO=client-team@example.com,manager@example.com

# Optional: CC recipients (comma-separated)
# EMAIL_TO_CC=backup@example.com

# Optional: BCC recipients (comma-separated)
# EMAIL_TO_BCC=archive@example.com

# Email subject prefix (Hebrew supported)
# EMAIL_SUBJECT_PREFIX=[דוח טיקטוק יומי]

# ============================================
# Optional Settings
# ============================================

# Run immediately on startup (for testing only)
# RUN_ON_STARTUP=true
